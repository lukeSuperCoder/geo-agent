# Geo-Agent
Geo-Agent æ˜¯ä¸€æ¬¾å¯¹è¯å¼åœ°å›¾å¯è§†åŒ–å¹³å°ï¼Œç”¨æˆ·å¯é€šè¿‡è‡ªç„¶è¯­è¨€ä¸ AI äº¤äº’ï¼Œç³»ç»ŸåŸºäºè¯­ä¹‰ç†è§£è‡ªåŠ¨è§£ææ„å›¾ã€è·å–æ•°æ®ï¼Œè”åŠ¨åœ°å›¾è¿›è¡Œå¯è§†åŒ–å±•ç¤ºï¼Œå®ç°"å¼€å£å³å¯è§"çš„æ™ºèƒ½ç©ºé—´ä¿¡æ¯æœåŠ¡ã€‚

## ğŸš€ é¡¹ç›®æ¶æ„

```
geo-agent/
â”œâ”€â”€ app/                    # åº”ç”¨ä¸»ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py          # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ api/               # APIå±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ websocket.py   # WebSocket API
â”‚   â”œâ”€â”€ core/              # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ ai_engine.py   # AIæ„å›¾è§£æå¼•æ“
â”‚   â”‚   â””â”€â”€ plugin_manager.py # æ’ä»¶ç®¡ç†å™¨
â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ message.py     # æ¶ˆæ¯æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ plugins/           # æ’ä»¶æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ weather_plugin.py # å¤©æ°”æŸ¥è¯¢æ’ä»¶
â”‚   â”‚   â””â”€â”€ poi_plugin.py  # POIæœç´¢æ’ä»¶
â”‚   â”œâ”€â”€ services/          # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ chat_service.py # èŠå¤©æœåŠ¡
â”‚   â””â”€â”€ utils/             # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ logger.py      # æ—¥å¿—å·¥å…·
â”œâ”€â”€ main.py                # åº”ç”¨å…¥å£
â”œâ”€â”€ requirements.txt       # ä¾èµ–åŒ…
â”œâ”€â”€ env.example           # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore           # Gitå¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md            # é¡¹ç›®è¯´æ˜
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**: FastAPI + WebSocket
- **AIé›†æˆ**: OpenAI API
- **æ’ä»¶ç³»ç»Ÿ**: å¯æ‰©å±•çš„æ’ä»¶æ¶æ„
- **æ—¥å¿—ç³»ç»Ÿ**: Loguru
- **é…ç½®ç®¡ç†**: Pydantic Settings

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
venv\Scripts\activate
# macOS/Linux
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶
cp env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„é…ç½®
# ç‰¹åˆ«æ˜¯ OpenAI API Key
OPENAI_API_KEY=your_openai_api_key_here
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
python main.py

# æˆ–è€…ä½¿ç”¨ uvicorn
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### 4. è®¿é—®æœåŠ¡

- **APIæ–‡æ¡£**: http://localhost:8000/docs
- **å¥åº·æ£€æŸ¥**: http://localhost:8000/health
- **æ’ä»¶çŠ¶æ€**: http://localhost:8000/plugins
- **WebSocket**: ws://localhost:8000/ws

## ğŸ”Œ æ’ä»¶ç³»ç»Ÿ

é¡¹ç›®é‡‡ç”¨æ’ä»¶åŒ–æ¶æ„ï¼Œæ”¯æŒä»¥ä¸‹æ’ä»¶ç±»å‹ï¼š

- **å¤©æ°”æŸ¥è¯¢** (`QWEATHER`): æŸ¥è¯¢æŒ‡å®šåœ°åŒºçš„å¤©æ°”ä¿¡æ¯
- **POIæœç´¢** (`BAIDU_MAP`): æœç´¢å…´è¶£ç‚¹ä¿¡æ¯
- **è·¯å¾„è§„åˆ’** (å¾…å®ç°): è®¡ç®—ä¸¤ç‚¹é—´çš„è·¯å¾„
- **åœ°ç†ç¼–ç ** (å¾…å®ç°): åœ°å€ä¸åæ ‡è½¬æ¢

### æ·»åŠ æ–°æ’ä»¶

1. åœ¨ `app/plugins/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„æ’ä»¶æ–‡ä»¶
2. ç»§æ‰¿ `BasePlugin` ç±»å¹¶å®ç°å¿…è¦çš„æ–¹æ³•
3. åœ¨æ’ä»¶æ–‡ä»¶ä¸­æ·»åŠ æ³¨å†Œå‡½æ•°
4. åœ¨ `ChatService` ä¸­å¯¼å…¥å¹¶æ³¨å†Œæ’ä»¶

## ğŸ“¡ WebSocket API

### è¿æ¥

```javascript
const ws = new WebSocket('ws://localhost:8000/ws/your-session-id');
```

### å‘é€æ¶ˆæ¯

```javascript
ws.send(JSON.stringify({
    "type": "user_input",
    "message": "æˆ‘æƒ³çœ‹çœ‹åŒ—äº¬çš„å¤©æ°”"
}));
```

### æ¥æ”¶æ¶ˆæ¯

```javascript
ws.onmessage = function(event) {
    const data = JSON.parse(event.data);
    console.log('æ”¶åˆ°æ¶ˆæ¯:', data);
    
    switch(data.type) {
        case 'intent_parsed':
            console.log('æ„å›¾è§£æç»“æœ:', data.intent);
            break;
        case 'plugin_result':
            console.log('æ’ä»¶æ‰§è¡Œç»“æœ:', data.data);
            break;
        case 'map_action':
            console.log('åœ°å›¾æ“ä½œæŒ‡ä»¤:', data.action);
            break;
    }
};
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. è‡ªç„¶è¯­è¨€ç†è§£
- åŸºäºOpenAIçš„æ„å›¾è§£æ
- æ”¯æŒå¤šç§åœ°ç†ä¿¡æ¯æŸ¥è¯¢æ„å›¾
- å‚æ•°è‡ªåŠ¨æå–å’ŒéªŒè¯

### 2. æ’ä»¶è°ƒåº¦
- æ ¹æ®æ„å›¾è‡ªåŠ¨é€‰æ‹©æ’ä»¶
- æ’ä»¶æ‰§è¡Œç»“æœæ ¼å¼åŒ–
- é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

### 3. åœ°å›¾è”åŠ¨
- ç”Ÿæˆåœ°å›¾æ“ä½œæŒ‡ä»¤
- æ”¯æŒé£è¡Œã€æ ‡è®°ã€è·¯å¾„ç­‰æ“ä½œ
- ä¸å‰ç«¯Cesiumåœ°å›¾é›†æˆ

## ğŸ”§ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„è¯´æ˜

- **`app/core/`**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
  - `ai_engine.py`: AIæ„å›¾è§£æå¼•æ“
  - `plugin_manager.py`: æ’ä»¶ç®¡ç†ç³»ç»Ÿ

- **`app/plugins/`**: æ’ä»¶å®ç°
  - æ¯ä¸ªæ’ä»¶éƒ½æ˜¯ç‹¬ç«‹çš„æ¨¡å—
  - éµå¾ªç»Ÿä¸€çš„æ¥å£è§„èŒƒ

- **`app/services/`**: æœåŠ¡å±‚
  - `chat_service.py`: èŠå¤©æœåŠ¡ï¼Œåè°ƒå„ä¸ªç»„ä»¶

- **`app/api/`**: APIæ¥å£å±‚
  - `websocket.py`: WebSocketè¿æ¥ç®¡ç†

### æ·»åŠ æ–°åŠŸèƒ½

1. **æ–°æ„å›¾ç±»å‹**: åœ¨ `app/models/message.py` ä¸­æ·»åŠ æ–°çš„ `IntentType`
2. **æ–°æ’ä»¶**: åœ¨ `app/plugins/` ä¸­åˆ›å»ºæ–°æ’ä»¶
3. **æ–°æœåŠ¡**: åœ¨ `app/services/` ä¸­æ·»åŠ ä¸šåŠ¡é€»è¾‘
4. **æ–°API**: åœ¨ `app/api/` ä¸­æ·»åŠ æ¥å£

## ğŸš§ å¾…å®ç°åŠŸèƒ½

- [ ] åœ°ç†ç¼–ç æ’ä»¶
- [ ] è·¯å¾„è§„åˆ’æ’ä»¶
- [ ] å®æ—¶äº¤é€šä¿¡æ¯
- [ ] è¯­éŸ³è¾“å…¥æ”¯æŒ
- [ ] å‰ç«¯Vue3 + Cesiumç•Œé¢
- [ ] ç”¨æˆ·ä¼šè¯ç®¡ç†
- [ ] æ’ä»¶çƒ­åŠ è½½
- [ ] æ€§èƒ½ç›‘æ§

## ğŸ“ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

---

**Geo-Agent** - è®©åœ°å›¾äº¤äº’æ›´æ™ºèƒ½ï¼

