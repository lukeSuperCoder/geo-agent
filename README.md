# geo-agent
Geo-Agent 是一款对话式地图可视化平台，用户可通过自然语言与 AI 交互，系统基于语义理解自动解析意图、获取数据，联动地图进行可视化展示，实现“开口即可见”的智能空间信息服务。
明白，Luke。基于你前述提出的系统构想（AI + Cesium 实现的智能地图可视化系统），结合你当前明确的前提「**数据不做本地存储，一切依赖第三方接口和大模型知识库进行实时获取**」，我为你重新整理并扩展了一份 **完整的技术需求文档（V2）**，包括系统结构、功能模块、技术选型建议，且涵盖不做本地数据持久化的前提。

---

## 🧭 AI 驱动的地图可视化系统 - 技术需求文档（V2）

### 一、系统概述

本系统是一个**对话式地图可视化平台**，用户通过自然语言与 AI 交互，系统基于语义识别自动执行相关指令，调用第三方 API 获取数据，实时联动 Cesium 地图展示内容。系统无需本地数据存储，一切数据通过实时请求获取。

---

### 二、整体架构（三层）

```txt
┌────────────┐
│ 前端可视化 │ Vue + Cesium + ChatUI
└────┬───────┘
     │ REST/WebSocket/事件
┌────▼───────┐
│ 中间指令层 │ Prompt编排 + Action路由
└────┬───────┘
     │ 指令分发 / 插件调用
┌────▼────────┐
│ 后台服务层  │ OpenAI/LLM + 三方数据接口
└─────────────┘
```

---

### 三、功能模块

#### 1. 对话交互模块（前端）

* 用户输入自然语言
* 基于语义识别生成意图
* 支持语音识别、语音合成（可选）
* 支持上下文多轮会话

#### 2. 意图解析与指令管理（中间层）

* 利用 LLM（如 GPT-4）理解意图
* 对应的意图生成 structured 指令（例如 JSON 格式）
* 根据指令匹配调用的 **插件/接口**

  * 地理查询（百度/高德 POI）
  * 实时天气（和风天气/高德）
  * 热点事件（新闻接口）
  * 动态路径规划（高德、百度、OSRM）
* 执行完毕后构建标准响应 → 返回前端

#### 3. 地图展示模块（前端 + Cesium）

* 根据执行结果进行地图联动：

  * 相机飞行（flyTo）
  * 实体展示（Entity / Primitive）
  * 轨迹动画 / 热力图 / 空间分析等
* 可视化模块调用结果实时展示，不存储数据

---

### 四、典型对话用例流程

> **用例：「我想看看北京的天气」**

```text
用户 → 前端（对话框）：
  “我想看看北京的天气”

前端 → 中间层：
  提交给 LLM 推理：
    {
      "intent": "get_weather",
      "location": "北京"
    }

中间层 → 调用插件：
  请求和风天气 API，获取北京当前天气

中间层 → 组织响应：
  {
    "text": "当前北京天气为晴，气温28°C。",
    "visualization": {
      "type": "marker",
      "position": [116.38, 39.9],
      "icon": "sunny"
    }
  }

前端 → 地图展示 + 文本回复
```

---

### 五、技术选型建议

#### 1. 前端层

| 模块    | 技术                                              |
| ----- | ----------------------------------------------- |
| 框架    | Vue 3 + Vite                                    |
| 地图引擎  | CesiumJS                                        |
| 地图通信  | viewer.scene.flyTo / entity.add / primitive API |
| 对话 UI | ChatGPT 风格组件（element-plus / 自定义）                |
| 音频处理  | WebSpeech API / Whisper WebAssembly             |
| 本地缓存  | 可选，仅用于运行态状态缓存，不做持久存储                            |

#### 2. 中间层（指令管理）

| 模块   | 技术                                |
| ---- | --------------------------------- |
| 服务框架 | Node.js + Express / Python Flask  |
| 指令编排 | LLM + Prompt 模板（例如使用 JSON Schema） |
| 接口管理 | OpenAPI + 插件模式（每类功能一个 adapter）    |
| 通信方式 | REST API / WebSocket 事件流          |

#### 3. 后端服务层

* 不负责数据库持久化，仅通过如下资源获取数据：

  * 大模型自身知识库（如 GPT-4）
  * 插件式第三方接口：

    * 百度/高德 POI
    * 和风天气
    * NewsAPI / RSS
    * 自定义 Python 爬虫
    * GeoNames / OpenStreetMap API
    * 经纬度 IP 定位服务

---

### 六、可扩展功能建议

| 功能模块   | 示例说明                   |
| ------ | ---------------------- |
| POI 查询 | “帮我找北京附近的公园”           |
| 路径导航   | “从天安门到北京大学怎么走”         |
| 地图聚焦   | “飞到广州塔”                |
| 实时数据   | “现在北京的空气质量怎么样”         |
| 多图层切换  | “显示当前城市的热力图”           |
| 轨迹模拟   | “播放珠峰攀登路线”             |
| 数据分析   | “统计北京市有多少个博物馆”（结合 OSM） |

---

### 七、安全与限制

* 所有请求仅在前端运行态缓存，不进行本地持久化
* 中间层需过滤敏感语义请求
* 插件调用需设置超时和异常处理
* 请求结果需具备合理格式校验，避免 LLM hallucination 风险

---

### 八、项目落地建议

| 阶段       | 任务                                     |
| -------- | -------------------------------------- |
| POC 快速验证 | 前端地图交互 + 中间层 prompt 调用 + 一个三方 API（POI） |
| MVP      | 增加对话管理 + 多意图 + 视觉同步                    |
| Alpha    | 加入多个插件、语音交互、飞行动画                       |
| Beta     | 整合 TTS、权限控制、语义知识图谱接口                   |
| 正式版本     | 部署为 SaaS 组件或嵌入业务系统                     |

---

你的项目是一个**AI 驱动的 Web 地图可视化工具**，具备自然语言问答、第三方数据联动、地图动态展示等能力。综合你目前的需求和我们前面交流的内容，你的项目的主要技术架构可以划分为以下三层：

---

# 技术栈介绍

## 🌐 一、前端层（用户交互层）

**技术栈：**

* **Vue 3 + Vite**：构建 SPA 前端应用
* **CesiumJS**：地图三维可视化展示
* **TailwindCSS / Element Plus**：UI 组件及样式
* **Web Worker / Audio APIs（可选）**：支持语音输入与播报
* **iFrame（嵌套第三方页面）**：若需要嵌入外部功能模块

**核心功能：**

* 自然语言输入（文字 / 语音）
* 对话与地图联动展示
* 可视化图层控制（热力图、标注、路径等）
* 执行结果展示区域（控制台 / 报告面板）
* 对第三方数据源的调用（如通过 AI 获取 POI，经纬度等）

---

## ⚙️ 二、中间层（AI 调度与能力代理层）

**技术栈建议：**

* **Node.js + Fastify / NestJS**：构建 API 服务，轻量快速
* **LangChain / LlamaIndex**（用于 Agent 任务链设计）
* **Function Calling / OpenAI Tools / LangGraph**：构建多步思维流程
* **Redis / KV 缓存**（用于短期记忆缓存或状态流转）
* **WebSocket / SSE**：支持前后端实时流式通讯

**核心功能：**

* 解析用户自然语言意图
* 根据意图匹配和调用对应的**函数/插件/接口**
* 封装请求逻辑调用外部 API（如百度地图、天地图、天气、交通等）
* 返回结构化响应结果给前端用于展示
* AI 能力：接入 GPT-4o / Claude / Gemini 等模型
* 支持 RAG 接入，调用知识库回答问题（可选）

---

## 🌍 三、外部接口层（数据来源）

**说明：你不负责存储，所有数据都来自于外部接口或大模型知识库**

**典型服务接口（需设计插件或函数绑定）：**

* 地理位置查询接口：百度地图 / 高德 / 腾讯位置服务
* 交通、天气、事件等开放数据接口（政务平台）
* 企业/机构 API 接口（如对接公安、旅游、灾害监测等）
* AI 模型知识库：模型原生能力（如 GPT 对“故宫”的认知）
* AI Agent工具插件：如搜索、爬虫、解析工具等

---

## 🔁 模块通信流程示意

```
用户输入（自然语言）👇
→ 前端传输请求给中间层 👇
→ AI Agent（中间层）识别意图 + 决策需要执行哪些步骤 👇
→ 自动调用外部 API 或插件 👇
→ 获取结构化数据，返回前端 👇
→ Cesium 动态可视化（自动飞行、添加标注等）
```

---

## ✅ 项目特色与关键设计点

| 模块      | 说明                      |
| ------- | ----------------------- |
| 自然语言控制  | 用户通过“对话”完成操作            |
| AI 代理调度 | 多步骤 Agent 自动执行数据检索与处理   |
| 地图联动展示  | AI 返回结果结构化后驱动 Cesium 操作 |
| 零数据存储   | 所有数据均由外部接口实时获取          |
| 插件机制    | 可扩展接入新的第三方服务            |
| 可插拔     | 功能组件（地图、语音、问答、图表）独立封装   |
| 可移植     | 前端+中间层松耦合设计，可部署在本地或私有云  |

---

## 🛠️ 可选增强功能建议（支持后续演进）

| 功能模块    | 实现建议                                  |
| ------- | ------------------------------------- |
| 语音输入/播报 | 浏览器原生 Web Speech API                  |
| 可视化报告导出 | 使用 `html2pdf.js` 导出当前地图视图与问答记录        |
| 图层分析功能  | 引入 turf.js / deck.gl 做空间分析            |
| 工具链插件化  | 设计插件注册系统（如注册“路线规划插件”、“天气插件”）          |
| RAG知识检索 | 可使用 LlamaIndex / LangChain + FAISS 接入 |
| 移动端支持   | 响应式设计 + Cesium 移动端适配策略                |

---

